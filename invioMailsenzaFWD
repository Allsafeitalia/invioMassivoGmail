function inviaEmailDaBozzaConDuplicato() {
  const sheet = SpreadsheetApp.getActiveSpreadsheet().getSheetByName('Destinatari');
  if (!sheet) {
    Logger.log("Il foglio 'Destinatari' non Ã¨ stato trovato. Assicurati che il foglio esista e che il nome sia corretto.");
    return;
  }

  const data = sheet.getDataRange().getValues();
  const parteNomeBozza = "Il tuo regalo aziendale scontato del 25%"; // Parte del nome della bozza
  const bozzaOriginale = GmailApp.getDraftMessages().find(draft => draft.getSubject().includes(parteNomeBozza));

  if (!bozzaOriginale) {
    Logger.log("Bozza non trovata. Assicurati che esista una bozza con il nome specificato.");
    return;
  }

  // Ciclo per ogni destinatario
  for (let i = 1; i < data.length; i++) {
    const email = data[i][1]; // Seconda colonna: Email

    // Crea una nuova bozza basata sulla bozza originale
    const nuovaBozza = GmailApp.createDraft(email, bozzaOriginale.getSubject(), "", {
      htmlBody: bozzaOriginale.getBody(),
      attachments: bozzaOriginale.getAttachments()
    });

    // Recupera la bozza appena creata e inviala
    nuovaBozza.send();
  }
}

